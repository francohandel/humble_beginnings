 {% extends 'base.html'%}
    {% block content%}

    {% if messages %}
        {% for message in messages %}
         {% if message.tags %}  <script>alert("{{ message }}")</script> {% endif %}

        {% endfor %}

    {% endif %}



   <style type="text/css">

   	.btns {
  margin-right: 15px;
  width: 50px;
}
   </style> 

<div style="background: url('/media/img/images/lab.jpg');background-repeat:no-repeat;background-size: cover; ">
<br>
<form action='/Confirmseat/'  method="POST" id="signup-form">
  {% csrf_token %}


<div class="container" style="background-color: maroon;width: 50%;" >

<div class="col-md-12">

<div class="form-row">
		{% for or in roomdetails %}  
    <div style="height: 200px">
	<div class="table-responsive">
		<br><br><br>
	<table class="table table-striped table-bordered table-sm" >  
    <thead style="background-color: #43504c;color: white" class="text-white">  
        <tr> 

        <th>B Id</th>  
        <th>room no</th>  
        <th>Fare</th>
        <th>select</th>
        
        
    </tr>  
    </thead>  
    <tbody>  


    

		<tr>  
	        <td>{{ or.B_id }}</td>  
	        <td>{{ or.Room_no }}</td>  
	        <td>{{ or.fare }}</td> 
	        
	        <td>   
	            <a href="/viewseat/{{ or.B_id }}/{{Tdate}}">Select</a>  
	        </td>
	        
	        
		</tr> 



    </tbody>  
	</table>

</div>
</div>

{% endfor %} 
</div>

</div>


<div class="col-md-12">
  	  <br>
    <div class="form-group col-md-4">
      <label style="color: black" for="inputEmail4">Date</label>
      <input type="text"   class="form-control" readonly="" name="Date" id="Date" value="{{Tdate}}"  placeholder="Bus Id">
    </div>  
{% for or in roomdetails %}  

 <div style="height: 200px">
  </div>
{% endfor %}



     {% for or in Roomd %} 
    <div class="form-group col-md-4">
      <label style="color: black" for="inputEmail4">Room Id</label>
     
     <input type="text"   class="form-control" readonly="" name="RoomId" id="RoomId"    value="{{or.B_id}}"  placeholder="Room Id">
      
    </div>


   

     
      
    </div>

  </div>


<div class="col-md-12">
  	  
    <div class="form-group col-md-4">
      <label style="color: black" for="inputEmail4">From</label>
      <input type="text"   class="form-control" readonly="" name="From" id="Room" value="{{or.Room_no}}"  placeholder="Room Id">
    </div>

 
    <div class="form-group col-md-4">
      <label style="color: black" for="inputEmail4">To</label>
     
    
      
    </div>


    <div class="form-group col-md-4">
      <label style="color: black" for="inputPassword4">Fare</label>
      <input type="Number"   class="form-control" readonly="" name="Fare" id="Fare" value="{{or.fare}}" placeholder="Number Of Person">
       
    </div>

  </div>



<div class="col-md-12">
  	
   
      
    </div>


    <div class="form-group col-md-4">
       <label style="color: black" for="inputPassword4">Number Of Person</label>
      <input type="Number"   class="form-control" name="numofperson" id="numofperson" onchange="candidatenumber()" value="1" placeholder="Number Of Person">
       <br> <br>
    </div>

  </div>







<div class="col-md-12" style=" border: solid; border-width: 5px; color: cornflowerblue; padding: 5px;">
<div>
	<center>
	<p>Select Your Seat</p> 
	</center>
 <input type="hidden"  name="seatnumbers" id="seatnumbers"  value="">
  <input type="hidden"  name="count" id="count"  value="1">

<img src="/media/img/images/driver.png" alt="Driver"  width="50" height="30">
  <div class="col-md-12"  style="margin-left: 30px;" >
  	
  	<div class="form-row">
 <input type="button" class="btn btns" onclick="selectseat(this)" value="1"  name="1"  id="1" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="5" name="5"  id="5" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="9" name="9"  id="9" />	
 <input type="button" class="btn btns" onclick="selectseat(this)" value="13" name="13"  id="13" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="17" name="17"  id="17" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="21" name="21"  id="21" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="25" name="25"  id="25" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="29" name="29"  id="29" />
      
     </div>
<br>

     <div class="form-row">


  <input type="button" class="btn btns" onclick="selectseat(this)" value="2" name="2"  id="2" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="6" name="6"  id="6" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="10" name="10"  id="10" />	
 <input type="button" class="btn btns" onclick="selectseat(this)" value="14" name="14"  id="14" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="18" name="18"  id="18" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="22" name="22"  id="22" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="26" name="26"  id="26" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="30" name="30"  id="30" />
     
     
     </div>
     </div>
  </div>

  <div class="col-md-12" style="margin-left: 30px;">

  	<br><br>
  	<div class="form-row">

 <input type="button" class="btn btns" onclick="selectseat(this)" value="3" name="3"  id="3" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="7" name="7"  id="7" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="11" name="11"  id="11" />	
 <input type="button" class="btn btns" onclick="selectseat(this)" value="15" name="15"  id="15" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="19" name="19"  id="19" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="23" name="23"  id="23" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="27" name="27"  id="27" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="31" name="31"  id="31" />
     
     </div>
<br>

     <div class="form-row">


 <input type="button" class="btn btns" onclick="selectseat(this)" value="4" name="4"  id="4" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="8" name="8"  id="8" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="12" name="12"  id="12" />	
 <input type="button" class="btn btns" onclick="selectseat(this)" value="16" name="16"  id="16" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="20" name="20"  id="20" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="24" name="24"  id="24" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="28" name="28"  id="28" />
 <input type="button" class="btn btns" onclick="selectseat(this)" value="32" name="32"  id="32" />
     
     </div>
     <br>
  </div>
<br>
 </div>



<input type="hidden" name="bookedseats" id="bookedseats" value="{{booked}}">

    <div class="form-row">
<div class="col-md-4">
    	</div>
    <div class="col-md-4" style="margin-bottom: 10px">
    	
    	<br>
		<div class="form-group">
    <label style="color: black" for="inputPassword4">Total</label>
 	<input type="text"  readonly=""  class="form-control" value="{{or.fare}}" name="totalprice" id="totalprice"><br>
	</div>
	
    </div>

  </div> 
 <center>

  <div class="form-row">

    <div class="col-md-12" style="margin-bottom: 10px">
    	
    	<center>
    		<a href="/Bookticket/" class="btn btn-warning"> Back</a> &nbsp; &nbsp; &nbsp;
      <button type="submit" class="btn btn-info">Proceed</button>
      </center>
      <br>
    </div>

  </div> 
</center>
{% endfor %}
</div>
<br>
</form>
</div>
<br>



<script type="text/javascript">

	$( document ).ready(function() {
	    var bookedseats = document.getElementById('bookedseats').value;
	    var seatsarray = bookedseats.split(',');
	    for (i = 0; i < seatsarray.length; i++) 
	    {
  		document.getElementById(seatsarray[i]).disabled = true;
  		document.getElementById(seatsarray[i]).style.backgroundColor = "white"
		}
	});



	function candidatenumber()
	{
		if(document.getElementById('numofperson').value < 1)
		{
			document.getElementById('numofperson').value = "1";

		}
		else if(document.getElementById('numofperson').value > 32)
		{
			document.getElementById('numofperson').value = "32";

		}

		var numofperson = document.getElementById('numofperson').value;
		var Fare = document.getElementById('Fare').value;
		var total = numofperson * Fare;
		document.getElementById('totalprice').value = total;
	}


	function selectseat(me)
	{
		var id = me.id;
		var count = document.getElementById('count').value;
		var num = document.getElementById('numofperson').value;
		if(document.getElementById(id).style.backgroundColor == "")
		{
			if(count <= num)
			{
					document.getElementById('seatnumbers').value += id +",";
					document.getElementById(id).style.backgroundColor = "Red";
					document.getElementById(id).style.color = "White";
          count++;
          document.getElementById('count').value = count;

			} 
			else
			{
				alert("you cannot select seat more the number of people");
			}
			

		}
		//else if ($('#'+id).css('background-color') == "red") 
    else if ( document.getElementById(id).style.backgroundColor == "red")
		{
			

			var stg = document.getElementById('seatnumbers').value;


			if(stg.includes(id))
			{
				var str = document.getElementById('seatnumbers').value;
				var count = document.getElementById('count').value;
				document.getElementById(id).style.backgroundColor = "";
				document.getElementById(id).style.color = "";
        newText = str.replace(id+",", ''); 
        document.getElementById('seatnumbers').value = newText; 
        count = count-1;
				document.getElementById('count').value = count;
			}
		}
	}

</script>
 {% endblock%}